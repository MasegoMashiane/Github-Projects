<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catch the Cake üéÇ</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'Comic Sans MS', cursive;
      background: linear-gradient(to top, #d357a1 0%, #02b497 100%);
      overflow: hidden;
      position: relative;
      height: 100vh;
    }
    .rainbow {
      position: absolute;
      bottom: 32vh;
      left: 50vw;
      background-size: cover;
      background-repeat: no-repeat;
      transform: translateX(-50%);
      width: 1500px;
      height: 420px;
      z-index: -3;
    }
    .castle {
      position: absolute;
      bottom: 0;
      left: 50vw;
      background-size: cover;
      background-repeat: no-repeat;
      transform: translateX(-50%);
      width: 450px;
      height: 450px;
      z-index: -1;
    }  
    .Foreground{
      position: absolute;
      bottom: 0;
      left: 50vw;
      background-size: cover;
      background-repeat: no-repeat;
      transform: translateX(-50%);
      width: 1500px;
      height: 450px;
      z-index: -2;
    }
    .sun {
      position: absolute;
      top: 1vh;
      right: 1vw;
      width: 200px;
      height: 200px;
      background: gold;
      border-radius: 50%;
      box-shadow: 0 0 30px yellow;
      z-index: -3;
    }
    #game {
      position: relative;
      width: 100vw;
      height: 100vh;
    }
    #basket {
      width: 130px;
      height: 100px;
      position: absolute;
      bottom: 20px;
      border-radius: 20px;
    }
    .cake {
      width: 40px;
      height: 40px;
      background: url('https://emojicdn.elk.sh/üßÅ') no-repeat center;
      background-size: contain;
      position: absolute;
    }
    #ComScoreContainer{
      display: flex;
      gap: 10rem;
    }
    #score {
      margin-top: 1vh;
      margin-left: 1px;
      font-size: 24px;
      color: rgb(97, 97, 196);
      background: white;
      padding: 8px 12px;
      max-height: 99px;
      border-radius: 10px;
      opacity: 0.75;
    }
    #comments{
        position: relative;
        color: rgb(97, 97, 196);
        padding: 8px 12px;
        border-radius: 10px;
        margin-right: 10rem;
        max-height: 105.375px;
        min-width: 93.281px;
        left: 10vw;
        top: 1vh;
        font-size: large;
        font-family: 'Comic Sans MS', cursive;
        text-align: center;
        height: auto;
        width: auto;
    }
  </style>
</head>
<body>
  <audio autoplay="autoplay" height="100" width="100" id="myAudio" loop>
    <source src="MIKA - Grace Kelly.mp3" type="audio/mp3" />
    <embed height="100" width="100" src="MIKA - Grace Kelly.mp3" />
  </audio>
  <div class="sun"></div>
  <img src="Rainbow.png" class="rainbow" alt="rainbow">
  <img src="foreground.png" class="Foreground" alt="Foreground">
  <img src="Castle.png" class="castle" alt="Princess Castle"/>
  <div id="game">
    <img src="basket.png" id="basket" alt="basket"/>
    <div id="ComScoreContainer">
      <div id="score">üéÇ Cakes: 0</div>
      <div id="comments">Right click your mouse to start game</div>
    </div>
  </div>
  <script>

    const errormessage = document.getElementById('errorMessage');
    
    function playAudio() {
      var audio = document.getElementById("myAudio");
      audio.play().catch((e) => {
      console.log(`playback failed: ${e}`)
    }
    );
  }  
    
  </script>
  <script>
    const game = document.getElementById('game');
    const basket = document.getElementById('basket');
    const scoreBoard = document.getElementById('score');
    let comments = document.getElementById('comments');
    let score = 0;

    // Move basket with mouse
    game.addEventListener('mousemove', (e) => {
      const x = e.clientX - basket.offsetWidth / 2;
      basket.style.left = `${x}px`;
    });

    game.addEventListener('click', (e) =>{
      console.log("clicked")
      playAudio();
      setInterval(createCake, 1200);
    });
    // Create cakes
    function createCake() {
      const cake = document.createElement('div');
      cake.classList.add('cake');
      cake.style.left = Math.random() * (window.innerWidth - 40) + 'px';
      cake.style.top = '0px';
      game.appendChild(cake);

      let fallInterval = setInterval(() => {
        const cakeTop = parseInt(cake.style.top);
        cake.style.top = cakeTop + 5 + 'px';

        const cakeRect = cake.getBoundingClientRect();
        const basketRect = basket.getBoundingClientRect();

        if 
        (
          cakeRect.bottom >= basketRect.top && cakeRect.left < basketRect.right && cakeRect.right > basketRect.left
        ) 
        {
          score++;
          game.removeChild(cake);
          clearInterval(fallInterval);
          scoreBoard.textContent = `üßÅCakes: ${score}`;

          if (score === 25){
            setTimeout(() => {
              document.body.innerHTML = `<div style="height: 100vh; background: linear-gradient(to top, #ff8fd8, #fff1f9); display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; font-family: 'Comic Sans MS', cursive;">
              <h1 style="font-size: 3rem;">üëë Cupcake Princess Crowned! üëë</h1>
              <p style="font-size: 1.5rem; max-width: 600px;">üéâ Careful now... that's one more cake away from jeans no longer fitting! üòú<br><br>Enjoy your day, Cupcakes üßÅ<br><br><em>P.S. I couldn't find a honeybun emoji, had to improvise.</em></p>
              <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; font-size: 1rem; border-radius: 10px; background: hotpink; color: white; border: none;">Play Again</button></div>`
              launchConfetti()
            }, 200);
          }
        }

        if (cakeTop > window.innerHeight) {
          game.removeChild(cake);
          clearInterval(fallInterval);
          if (score < 25) {
            const messages = [
              "You dropped my cousin! üò§",
              "CAKE down! üç∞üíÄ",
              "oooh! missed! BUT HEY,Abs say thanks",
              "Oops! There goes dessert üòÖ",
              "Gravity's winning today.",
              "Another one bites the frosting."
            ];
            
            comments.textContent = (messages[Math.floor(Math.random() * messages.length)]);
          }
        }
      }, 30);
    }

    // Confetti Launcher
    function launchConfetti(){
      for(let i = 0; i < 100; i++){
        let Confetti = document.createElement('div');
        Confetti.style.position = `fixed`;
        Confetti.style.width = `10px`;
        Confetti.style.height = `10px`;
        Confetti.style.background = `hsl(${Math.random()*360}, 100%, 70%)`;
        Confetti.style.top = `-10px`;
        Confetti.style.left = Math.random()*100 +'vw'
        Confetti.style.animation = `fall ${2 + Math.random()*3}s linear forwards`;
        Confetti.style.transform = `rotate(${Math.random()*360}deg)`;
        Confetti.style.zIndex = 30;
        document.body.appendChild(Confetti);
      }

      const style = document.createElement('style');
      style.textContent = `@keyframes 
      fall{
        to {
      transform: translateY(100vh) rotate(720deg);
      }
      }`;
      document.head.appendChild(style);
    }
  </script>
</body>
</html>